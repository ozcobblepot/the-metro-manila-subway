<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Fares — Metro Manila Subway</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top shadow-sm">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <img src="assets/logo2.png" alt="Metro Manila Subway Logo" class="logo">
            </a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">Home</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Riding MMS
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="transit.html">Transit Services</a></li>
                            <li><a class="dropdown-item" href="accessing.html">Accessing MMS</a></li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="fares.html">Fares</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="alerts.html">Alerts</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            About Us
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="about.html#contact">Contact</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

    <main class="py-5">
        <div class="container">
            <div class="py-5 text-center" style="padding-top: calc(var(--navbar-height) + 2rem);">
                <h1 class="display-6 text-primary">Single Journey Fare Matrix</h1>
                <p class="text-muted">Stations follow the route map (north → south). Diagonal values are 0. Download CSV to edit fares.</p>
            </div>

            <div class="card p-4">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <div>
                        <h6 class="mb-0">Fare matrix (From → To)</h6>
                    </div>
                    <div class="d-flex gap-2">
                        <button id="downloadCsv" class="btn btn-primary btn-sm"><i class="bi bi-download"></i> Download CSV</button>
                        <button id="printBtn" class="btn btn-outline-secondary btn-sm">Print</button>
                        <a href="index.html" class="btn btn-link btn-sm">Back to Home</a>
                    </div>
                </div>

                <div class="table-responsive" style="max-height:70vh;overflow:auto;">
                    <table id="fare-table" class="table table-bordered table-sm text-center mb-0">
                        <!-- header and body generated by script -->
                    </table>
                </div>

                <div class="mt-3">
                    <small class="text-muted">Tip: After downloading the CSV you can fill fares in Excel and re-import/update on your system.</small>
                </div>
            </div>

            <!-- Bootstrap Carousel Slideshow -->
            <div id="faresCarousel" class="carousel slide mb-3" data-bs-ride="carousel">
              <div class="carousel-indicators">
                <button type="button" data-bs-target="#faresCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                <button type="button" data-bs-target="#faresCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
                <button type="button" data-bs-target="#faresCarousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
              </div>
              <div class="carousel-inner">
                <div class="carousel-item active">
                  <img src="assets/image1.jpg" class="d-block w-100" alt="Fare Payment">
                  <div class="carousel-caption d-none d-md-block">
                    <h5>Contactless Payment</h5>
                    <p>Quick and easy payment with smart cards and mobile wallets.</p>
                  </div>
                </div>
                <div class="carousel-item">
                  <img src="assets/image1.jpg" class="d-block w-100" alt="Discount Cards">
                  <div class="carousel-caption d-none d-md-block">
                    <h5>Discounts Available</h5>
                    <p>Special rates for seniors, students, and PWDs.</p>
                  </div>
                </div>
                <div class="carousel-item">
                  <img src="assets/image1.jpg" class="d-block w-100" alt="Refill Stations">
                  <div class="carousel-caption d-none d-md-block">
                    <h5>Easy Refills</h5>
                    <p>Top up your card at kiosks or online anytime.</p>
                  </div>
                </div>
              </div>
              <button class="carousel-control-prev" type="button" data-bs-target="#faresCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
              </button>
              <button class="carousel-control-next" type="button" data-bs-target="#faresCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
              </button>
            </div>
        </div>
    </main>

    <footer class="bg-primary text-white py-4 mt-5">
        <div class="container text-center">
            <small>&copy; 2023 Metro Manila Subway</small>
        </div>
    </footer>

    <script>
        // station names (north → south) from provided map
        const stations = [
        "East Valenzuela",
        "Quirino Highway",
        "Tandang Sora",
        "North Avenue",
        "Quezon Avenue",
        "East Avenue",
        "Anonas",
        "Camp Aguinaldo",
        "Ortigas",
        "Shaw Boulevard",
        "Kalayaan Avenue",
        "BGC",
        "Lawton Avenue",
        "Senate-DepEd",
        "NAIA Terminal 3",
        "FTI",
        "Bicutan"
    ];

    // simple fare formula:
    // distance = number of station hops (absolute difference in index)
    // fare = 0 for same station, otherwise base + increment * distance
    const FARE_BASE = 10;     // base constant so distance 1 -> 15
    const FARE_STEP = 5;      // per-station increment

    function fareForDistance(distance) {
        if (distance === 0) return 0;
        return FARE_BASE + FARE_STEP * distance;
    }

    // build table DOM: header + tbody with computed fares
    function buildFareTable() {
        const table = document.getElementById('fare-table');
        table.innerHTML = '';

        const thead = document.createElement('thead');
        thead.className = 'table-primary';
        const headRow = document.createElement('tr');
        const thCorner = document.createElement('th');
        thCorner.textContent = 'From \\ To';
        headRow.appendChild(thCorner);
        stations.forEach(name => {
            const th = document.createElement('th');
            th.scope = 'col';
            th.textContent = name;
            headRow.appendChild(th);
        });
        thead.appendChild(headRow);
        table.appendChild(thead);

        const tbody = document.createElement('tbody');
        stations.forEach((from, r) => {
            const tr = document.createElement('tr');
            const thRow = document.createElement('th');
            thRow.scope = 'row';
            thRow.className = 'text-start';
            thRow.textContent = from;
            tr.appendChild(thRow);

            stations.forEach((to, c) => {
                const td = document.createElement('td');
                const distance = Math.abs(r - c);
                td.textContent = String(fareForDistance(distance));
                tr.appendChild(td);
            });

            tbody.appendChild(tr);
        });
        table.appendChild(tbody);
    }

    // convert current table to CSV
    function tableToCsv(table) {
        const rows = Array.from(table.querySelectorAll('tr'));
        return rows.map(row => {
            const cells = Array.from(row.querySelectorAll('th,td'));
            return cells.map(c => '"' + c.innerText.replace(/"/g,'""') + '"').join(',');
        }).join('\n');
    }

    // download CSV
    function downloadCsv() {
        const table = document.getElementById('fare-table');
        const csv = tableToCsv(table);
        const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'metro_fares_matrix_17stations.csv';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    }

    // print page
    function printPage() {
        window.print();
    }

    // init
    document.addEventListener('DOMContentLoaded', function () {
        buildFareTable();
        const dl = document.getElementById('downloadCsv');
        const pr = document.getElementById('printBtn');
        if (dl) dl.addEventListener('click', downloadCsv);
        if (pr) pr.addEventListener('click', printPage);
    });
</script>

<!-- add these scripts near the end of <body> (before bootstrap.bundle.js) -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="script.js"></script>
</body>
</html>